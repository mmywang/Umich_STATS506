<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STAT506PS4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="STAT506PS4_files/libs/clipboard/clipboard.min.js"></script>
<script src="STAT506PS4_files/libs/quarto-html/quarto.js"></script>
<script src="STAT506PS4_files/libs/quarto-html/popper.min.js"></script>
<script src="STAT506PS4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="STAT506PS4_files/libs/quarto-html/anchor.min.js"></script>
<link href="STAT506PS4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="STAT506PS4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="STAT506PS4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="STAT506PS4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="STAT506PS4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STAT506PS4</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"nycflights13"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"survey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid
Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack

Loading required package: survival

Attaching package: 'survey'

The following object is masked from 'package:graphics':

    dotchart</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"haven"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="question1" class="level2">
<h2 class="anchored" data-anchor-id="question1">Question1</h2>
<p>(1)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The first table Dep_delay</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Dep_delay <span class="ot">&lt;-</span> flights<span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin)<span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Dep_delay_mean =</span> <span class="fu">mean</span>(dep_delay,<span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">Dep_delay_median =</span> <span class="fu">median</span>(dep_delay,<span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Dep_delay_mean))<span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(airports, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"origin"</span> <span class="ot">=</span> <span class="st">"faa"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">origin =</span> name, Dep_delay_mean, Dep_delay_median)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Dep_delay,<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  origin              Dep_delay_mean Dep_delay_median
  &lt;chr&gt;                        &lt;dbl&gt;            &lt;dbl&gt;
1 Newark Liberty Intl           15.1               -1
2 John F Kennedy Intl           12.1               -1
3 La Guardia                    10.3               -3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The second table Arr_delay</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Arr_delay <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest)<span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;=</span><span class="dv">10</span>)<span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Arr_delay_mean =</span> <span class="fu">mean</span>(arr_delay,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),<span class="at">Arr_delay_median =</span> <span class="fu">median</span>(arr_delay,<span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Arr_delay_mean))<span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(airports,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dest"</span> <span class="ot">=</span> <span class="st">"faa"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">dest =</span> name,Arr_delay_mean, Arr_delay_median)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Arr_delay,<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 102 × 3
    dest                                   Arr_delay_mean Arr_delay_median
    &lt;chr&gt;                                           &lt;dbl&gt;            &lt;dbl&gt;
  1 "Columbia Metropolitan"                       41.8                28  
  2 "Tulsa Intl"                                  33.7                14  
  3 "Will Rogers World"                           30.6                16  
  4 "Jackson Hole Airport"                        28.1                15  
  5 "Mc Ghee Tyson"                               24.1                 2  
  6 "Dane Co Rgnl Truax Fld"                      20.2                 1  
  7 "Richmond Intl"                               20.1                 1  
  8 "Akron Canton Regional Airport"               19.7                 3  
  9 "Des Moines Intl"                             19.0                 0  
 10 "Gerald R Ford Intl"                          18.2                 1  
 11 "Birmingham Intl"                             16.9                -2  
 12 "Theodore Francis Green State"                16.2                 1  
 13 "Greenville-Spartanburg International"        15.9                -0.5
 14 "Cincinnati Northern Kentucky Intl"           15.4                -3  
 15 "Savannah Hilton Head Intl"                   15.1                -1  
 16 "Manchester Regional Airport"                 14.8                -3  
 17 "Eppley Afld"                                 14.7                -2  
 18 "Yeager"                                      14.7                -1.5
 19 "Kansas City Intl"                            14.5                 0  
 20 "Albany Intl"                                 14.4                -4  
 21 "General Mitchell Intl"                       14.2                 0  
 22 "Piedmont Triad"                              14.1                -2  
 23 "Washington Dulles Intl"                      13.9                -3  
 24 "Cherry Capital Airport"                      13.0               -10  
 25 "James M Cox Dayton Intl"                     12.7                -3  
 26 "Louisville International Airport"            12.7                -2  
 27 "Chicago Midway Intl"                         12.4                -1  
 28 "Sacramento Intl"                             12.1                 4  
 29 "Jacksonville Intl"                           11.8                -2  
 30 "Nashville Intl"                              11.8                -2  
 31 "Portland Intl Jetport"                       11.7                -4  
 32 "Greater Rochester Intl"                      11.6                -5  
 33 "Hartsfield Jackson Atlanta Intl"             11.3                -1  
 34 "Lambert St Louis Intl"                       11.1                -3  
 35 "Norfolk Intl"                                10.9                -4  
 36 "Baltimore Washington Intl"                   10.7                -5  
 37 "Memphis Intl"                                10.6                -2.5
 38 "Port Columbus Intl"                          10.6                -3  
 39 "Charleston Afb Intl"                         10.6                -4  
 40 "Philadelphia Intl"                           10.1                -3  
 41 "Raleigh Durham Intl"                         10.1                -3  
 42 "Indianapolis Intl"                            9.94               -3  
 43 "Charlottesville-Albemarle"                    9.5                -5  
 44 "Cleveland Hopkins Intl"                       9.18               -5  
 45 "Ronald Reagan Washington Natl"                9.07               -2  
 46 "Burlington Intl"                              8.95               -4  
 47 "Buffalo Niagara Intl"                         8.95               -5  
 48 "Syracuse Hancock Intl"                        8.90               -5  
 49 "Denver Intl"                                  8.61               -2  
 50 "Palm Beach Intl"                              8.56               -3  
 51  &lt;NA&gt;                                          8.25               -1  
 52 "Bob Hope"                                     8.18               -3  
 53 "Fort Lauderdale Hollywood Intl"               8.08               -3  
 54 "Bangor Intl"                                  8.03               -9  
 55 "Asheville Regional Airport"                   8.00               -1  
 56  &lt;NA&gt;                                          7.87                0  
 57 "Pittsburgh Intl"                              7.68               -5  
 58 "Gallatin Field"                               7.6                -2  
 59 "NW Arkansas Regional"                         7.47               -2  
 60 "Tampa Intl"                                   7.41               -4  
 61 "Charlotte Douglas Intl"                       7.36               -3  
 62 "Minneapolis St Paul Intl"                     7.27               -5  
 63 "William P Hobby"                              7.18               -4  
 64 "Bradley Intl"                                 7.05              -10  
 65 "San Antonio Intl"                             6.95               -9  
 66 "South Bend Rgnl"                              6.5                -3.5
 67 "Louis Armstrong New Orleans Intl"             6.49               -6  
 68 "Key West Intl"                                6.35                7  
 69 "Eagle Co Rgnl"                                6.30               -4  
 70 "Austin Bergstrom Intl"                        6.02               -5  
 71 "Chicago Ohare Intl"                           5.88               -8  
 72 "Orlando Intl"                                 5.45               -5  
 73 "Detroit Metro Wayne Co"                       5.43               -7  
 74 "Portland Intl"                                5.14               -5  
 75 "Nantucket Mem"                                4.85               -3  
 76 "Wilmington Intl"                              4.64               -7  
 77 "Myrtle Beach Intl"                            4.60              -13  
 78 "Albuquerque International Sunport"            4.38               -5.5
 79 "George Bush Intercontinental"                 4.24               -5  
 80 "Norman Y Mineta San Jose Intl"                3.45               -7  
 81 "Southwest Florida Intl"                       3.24               -5  
 82 "San Diego Intl"                               3.14               -5  
 83 "Sarasota Bradenton Intl"                      3.08               -5  
 84 "Metropolitan Oakland Intl"                    3.08               -9  
 85 "General Edward Lawrence Logan Intl"           2.91               -9  
 86 "San Francisco Intl"                           2.67               -8  
 87  &lt;NA&gt;                                          2.52               -6  
 88 "Yampa Valley"                                 2.14                2  
 89 "Phoenix Sky Harbor Intl"                      2.10               -6  
 90 "Montrose Regional Airport"                    1.79              -10.5
 91 "Los Angeles Intl"                             0.547              -7  
 92 "Dallas Fort Worth Intl"                       0.322              -9  
 93 "Miami Intl"                                   0.299              -9  
 94 "Mc Carran Intl"                               0.258              -8  
 95 "Salt Lake City Intl"                          0.176              -8  
 96 "Long Beach"                                  -0.0620            -10  
 97 "Martha\\\\'s Vineyard"                       -0.286             -11  
 98 "Seattle Tacoma Intl"                         -1.10              -11  
 99 "Honolulu Intl"                               -1.37               -7  
100  &lt;NA&gt;                                         -3.84               -9  
101 "John Wayne Arpt Orange Co"                   -7.87              -11  
102 "Palm Springs Intl"                          -12.7               -13.5</code></pre>
</div>
</div>
<p>(b)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>average_speed <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">speed =</span> distance <span class="sc">/</span> (air_time <span class="sc">/</span> <span class="dv">60</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_speed =</span> <span class="fu">mean</span>(speed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_flights =</span> <span class="fu">n</span>()</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_speed)) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>average_speed  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  model   avg_speed num_flights
  &lt;chr&gt;       &lt;dbl&gt;       &lt;int&gt;
1 777-222      483.           4</code></pre>
</div>
</div>
</section>
<section id="question2" class="level2">
<h2 class="anchored" data-anchor-id="question2">Question2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>get_temp <span class="ot">&lt;-</span> <span class="cf">function</span>(month,year,data,<span class="at">celsius =</span> <span class="cn">FALSE</span>,<span class="at">average_fn =</span> mean){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Check valid year</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(year)<span class="sc">||</span> year <span class="sc">&lt;</span> <span class="fu">min</span>(data<span class="sc">$</span>year) <span class="sc">||</span> year <span class="sc">&gt;</span> <span class="fu">max</span>(data<span class="sc">$</span>year)){</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Invalid year input"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Check valid year and transfer year to abbreviated month format</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  month_names_abbrev <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>, <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dec"</span>) </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  month_names_full <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>, <span class="st">"June"</span>, <span class="st">"July"</span>, <span class="st">"August"</span>, <span class="st">"September"</span>, <span class="st">"October"</span>, <span class="st">"November"</span>, <span class="st">"December"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (month <span class="sc">%in%</span> month_names_full){</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> month_names_abbrev[<span class="fu">which</span>(month_names_full <span class="sc">==</span> month)]</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.numeric</span>(month)){</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(month <span class="sc">&gt;</span> <span class="dv">12</span> <span class="sc">||</span> month <span class="sc">&lt;</span> <span class="dv">1</span>){</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Invalid month input."</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> month_names_abbrev[month]</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(<span class="sc">!</span>month <span class="sc">%in%</span> month_names_abbrev) {</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Invalid month"</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#get the result</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  avg_temp <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> <span class="sc">!!</span>year <span class="sc">&amp;</span> month <span class="sc">==</span> <span class="sc">!!</span>month) <span class="sc">%&gt;%</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">avg_temperature =</span> <span class="fu">average_fn</span>(temp)) <span class="sc">%&gt;%</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(avg_temperature)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#check the format for temperature</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(celsius) {</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    avg_temp <span class="ot">&lt;-</span> (avg_temp <span class="sc">-</span> <span class="dv">32</span>) <span class="sc">*</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">9</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(avg_temp)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>nnmaps <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/meredithwang/Downloads/chicago-nmmaps.csv"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_temp</span>(<span class="st">"Apr"</span>, <span class="dv">1999</span>, <span class="at">data =</span> nnmaps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 49.8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_temp</span>(<span class="st">"Apr"</span>, <span class="dv">1999</span>, <span class="at">data =</span> nnmaps, <span class="at">celsius =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.888889</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_temp</span>(<span class="dv">10</span>, <span class="dv">1998</span>, <span class="at">data =</span> nnmaps, <span class="at">average_fn =</span> median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_temp</span>(<span class="dv">13</span>, <span class="dv">1998</span>, <span class="at">data =</span> nnmaps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in get_temp(13, 1998, data = nnmaps): Invalid month input.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_temp</span>(<span class="dv">2</span>, <span class="dv">2005</span>, <span class="at">data =</span> nnmaps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in get_temp(2, 2005, data = nnmaps): Invalid year input</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_temp</span>(<span class="st">"November"</span>, <span class="dv">1999</span>, <span class="at">data =</span>nnmaps, <span class="at">celsius =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">average_fn =</span> <span class="cf">function</span>(x) {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>           x <span class="sc">%&gt;%</span> sort <span class="ot">-&gt;</span> x</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>           x[<span class="dv">2</span><span class="sc">:</span>(<span class="fu">length</span>(x) <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">%&gt;%</span> mean <span class="sc">%&gt;%</span> return</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>         })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.301587</code></pre>
</div>
</div>
</section>
<section id="question3" class="level2">
<h2 class="anchored" data-anchor-id="question3">Question3</h2>
<p>(a)</p>
<pre class="sas"><code>/* import data */
proc import datafile="/home/u63646271/sasuser.v94/recs2020_public_v5.csv" out=recs2020 replace;

/* Calculate the weights for all states */
proc sql noprint;
   /* weight of each state */
   create table state_weights as
   select state_name, sum(NWEIGHT) as total_weight
   from recs2020
   group by state_name;
   
   select sum(NWEIGHT) into :totalWeight from recs2020;
   
   /* percentage of each state and sort */
   create table state_percent as
   select state_name, 
          total_weight / &amp;totalWeight as percentage
   from state_weights
   order by percentage desc;
run;

/* Calculate the highest percentage */
proc print data=state_percent(obs=1); 
   var state_name percentage;
run;

/* Calculate the Percentage of All Records for Michigan */
proc sql;
   select state_name, percentage 
   from state_percent 
   where state_name = "Michigan";
run;</code></pre>
<p>(b)</p>
<pre class="sas"><code>data positive_elec_cost;
    set recs2020;
    if DOLLAREL &gt; 0;
run;

proc sgplot data=positive_elec_cost;
    histogram DOLLAREL;
    title "Histogram of Total Electricity Cost (Strictly Positive Values)";
    xaxis label="Total Electricity Cost";
    yaxis label="Number of Houses";
run;</code></pre>
<p>(c)</p>
<pre class="sas"><code>data log_elec_cost;
    set recs2020;
    if DOLLAREL &gt; 0 then log_elec = log(DOLLAREL); 
    else delete; 
run;

/* Plot the histogram */
proc sgplot data=log_elec_cost;
    histogram log_elec;
    title "Histogram of Log-transformed Total Electricity Cost";
    xaxis label="Log of Total Electricity Cost";
    yaxis label="Number of Houses";
run;</code></pre>
<p>(d)</p>
<pre class="sas"><code>data prep_data;
    set recs2020;
    if DOLLAREL &gt; 0 then log_elec = log(DOLLAREL);
    else delete; 

    if PRKGPLC1 = 1 then has_garage = 1;
    else has_garage = 0;
    
run;

proc reg data=prep_data;
    model log_elec = TOTROOMS has_garage;
    weight NWEIGHT; 
    title "Linear Regression Model Predicting Log of Electricity Cost";
run;</code></pre>
<p>（e)</p>
<pre class="sas"><code>/* Fit the model and save the predicted values */
proc reg data=prep_data outest=estimates noprint;
    model log_elec = TOTROOMS has_garage;
    output out=predicted_data p=pred_log_elec;
run;

data predicted_data;
    set predicted_data;
    pred_elec_cost = exp(pred_log_elec); 
run;

proc sgplot data=predicted_data;
    scatter x=DOLLAREL y=pred_elec_cost;
    lineparm x=0 y=0 slope=1 / clip; 
    title "Scatterplot of Predicted vs. Actual Total Electricity Cost";
run;</code></pre>
</section>
<section id="question4" class="level2">
<h2 class="anchored" data-anchor-id="question4">Question4</h2>
<p>(b)</p>
<pre class="sas"><code>/* import data to SAS */
proc import datafile="/home/u63646271/sasuser.v94/public2022.csv" out=public2022 replace;

/* Question4(b) Choose variables of interest */
proc sql;
    create table select_data as
    select CaseID, weight_pop,
        B3, 
        ND2, 
        B7_b, 
        GH1, 
        educ_4cat, 
        ppethm
    from public2022;
run;</code></pre>
<p>(c)</p>
<pre class="sas"><code>proc export
   data = select_data
   outfile = "/home/u63646271/sasuser.v94/analysis_data.csv"
   dbms = CSV;
run;</code></pre>
<p>(d)</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a> import delimited <span class="st">"/Users/meredithwang/Downloads/analysis_data.csv"</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>(encoding automatically selected: ISO-8859-1)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>(8 vars, 11,667 <span class="kw">obs</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After I import the data into STATA, the data has 6 variables as we selected before and also 11668 observations which is also the same as the Cook book.</p>
<p>(e)</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> wealth_binary = (b3 == <span class="st">"Somewhat worse off"</span> | b3 == <span class="st">"Much worse off"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">encode</span> nd2, <span class="kw">generate</span>(nd2_num)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> nd2_label 1 <span class="st">"Much higher"</span> 2 <span class="st">"Somewhat higher"</span> 3 <span class="st">"About the same"</span> 4 <span class="st">"Somewhat lower"</span> 5 <span class="st">"Much lower"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">values</span> nd2_num nd2_label</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="kw">encode</span> b7_b, <span class="kw">generate</span>(b7_b_num)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> b7_b_label 1 <span class="st">"Poor"</span> 2 <span class="st">"Only fair"</span> 3 <span class="st">"Good"</span> 4 <span class="st">"Excellent"</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">values</span> b7_b_num b7_b_label</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="kw">encode</span> gh1, <span class="kw">generate</span>(gh1_num)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> gh1_label 1 <span class="st">"Own your home with a mortgage or loan"</span> 2 <span class="st">"Own your home free and clear (without a mortgage or loan)"</span> 3 <span class="st">"Pay rent"</span> 4 <span class="st">"Neither own nor pay rent"</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">values</span> gh1_num gh1_label</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="kw">encode</span> educ_4cat, <span class="kw">generate</span>(educ_4cat_num)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> educ_4cat_label 1 <span class="st">"Less than a high school degree"</span> 2 <span class="st">"High school degree or GED"</span> 3 <span class="st">"Some college/technical or associates degree"</span> 4 <span class="st">"Bachelor's degree or more"</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">values</span> educ_4cat_num educ_4cat_label</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="kw">encode</span> ppethm, <span class="kw">generate</span>(ppethm_num)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">define</span> ppethm_label 1 <span class="st">"White, Non-Hispanic"</span> 2 <span class="st">"Black, Non-Hispanic"</span> 3 <span class="st">"Other, Non-Hispanic"</span> 4 <span class="st">"Hispanic"</span> 5 <span class="st">"2+ Races, Non-Hispanic"</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> <span class="kw">values</span> ppethm_num ppethm_label</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">svyset</span> caseid [pw=weight_pop]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>. <span class="kw">svy</span>: <span class="kw">logistic</span> wealth_binary i.nd2_num i.b7_b_num i.gh1_num i.educ_4cat_num i.ppethm_num</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>(running <span class="kw">logistic</span> <span class="kw">on</span> estimation <span class="kw">sample</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>Survey: Logistic regression</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>Number <span class="kw">of</span> <span class="kw">strata</span> =      1                        Number <span class="kw">of</span> <span class="kw">obs</span>   =      11,667</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>Number <span class="kw">of</span> PSUs   = 11,667                        Population <span class="kw">size</span> = 255,114,223</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>                                                 Design df       =      11,666</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">F</span>(17, 11650)    =       57.42</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                                                 Prob &gt; <span class="fu">F</span>        =      0.0000</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>----------------------------------------------------------------------------------------------------------------------------</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>                                                           |             Linearized</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                                             wealth_binary | Odds <span class="kw">ratio</span>   <span class="fu">std</span>. err.      t    P&gt;|t|     [95% conf. interval]</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>-----------------------------------------------------------+----------------------------------------------------------------</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                                                   nd2_num |</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                                          Somewhat higher  |   1.074973   .0909575     0.85   0.393     .9106824    1.268903</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                                           About the same  |   .8474572   .1282401    -1.09   0.274     .6299379    1.140087</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                                           Somewhat <span class="fu">lower</span>  |   .9813484   .0540987    -0.34   0.733     .8808343    1.093332</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>                                               Much <span class="fu">lower</span>  |   .8243532   .1579435    -1.01   0.313     .5662509    1.200101</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>                                                           |</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>                                                  b7_b_num |</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>                                                Only fair  |   1.974776   .6917774     1.94   0.052      .993814    3.924013</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>                                                     Good  |   3.953395   1.362284     3.99   0.000     2.011999    7.768062</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>                                                Excellent  |   11.98335   4.130326     7.21   0.000     6.097651    23.55017</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>                                                           |</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>                                                   gh1_num |</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>Own your home free and <span class="kw">clear</span> (without a mortgage <span class="kw">or</span> loan)  |   1.517157   .1572363     4.02   0.000     1.238237    1.858905</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>                                                 Pay rent  |   1.422295   .1417282     3.54   0.000     1.169932    1.729094</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>                                 Neither own nor pay rent  |   1.385568   .1436771     3.14   0.002     1.130715    1.697864</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>                                                           |</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>                                             educ_4cat_num |</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>                                High school degree <span class="kw">or</span> GED  |   1.226953   .0770309     3.26   0.001     1.084881    1.387631</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>              Some college/technical <span class="kw">or</span> associates degree  |   1.396686    .155816     2.99   0.003     1.122349     1.73808</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>                                Bachelor's degree <span class="kw">or</span> <span class="kw">more</span>  |   1.162817    .061381     2.86   0.004     1.048516    1.289579</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>                                                           |</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>                                                ppethm_num |</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>                                      Black, Non-Hispanic  |   .4458974   .0687591    -5.24   0.000     .3295815    .6032635</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>                                      Other, Non-Hispanic  |   .7637862   .1143198    -1.80   0.072     .5695802    1.024209</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>                                                 Hispanic  |    .635055   .1135432    -2.54   0.011     .4473082    .9016039</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>                                   2+ Races, Non-Hispanic  |   .9073112   .1243138    -0.71   0.478     .6936145    1.186846</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>                                                           |</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>                                                     <span class="dt">_cons</span> |    .076848   .0289352    -6.81   0.000     .0367368    .1607549</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>----------------------------------------------------------------------------------------------------------------------------</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>Note: <span class="dt">_cons</span> <span class="kw">estimates</span> baseline odds.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Based on the result above, we can find that none of the categorical of predictor ‘nd2_num’ has p-value less than 0.05, which gives us that none of the categories of the predictorare significantly different from the reference category in terms of predicting financial situation relative to the previous year.</p>
<p>(f)</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>.<span class="kw">save</span> <span class="st">"/Users/meredithwang/Desktop/Course/STAT506/Umich_stats506/analysis_data2.dta"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(g)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>public_2022 <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"/Users/meredithwang/Desktop/Course/STAT506/Umich_stats506/analysis_data2.dta"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(public_2022)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "caseid"        "weight_pop"    "b3"            "nd2"          
 [5] "b7_b"          "gh1"           "educ_4cat"     "ppethm"       
 [9] "wealth_binary" "nd2_num"       "b7_b_num"      "gh1_num"      
[13] "educ_4cat_num" "ppethm_num"   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>des <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">id =</span> <span class="sc">~</span>caseid, <span class="at">weights =</span> <span class="sc">~</span>weight_pop, <span class="at">data =</span> public_2022)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(wealth_binary <span class="sc">~</span> <span class="fu">factor</span>(nd2_num) <span class="sc">+</span> <span class="fu">factor</span>(b7_b_num) <span class="sc">+</span> <span class="fu">factor</span>(gh1_num) <span class="sc">+</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">factor</span>(educ_4cat_num) <span class="sc">+</span> <span class="fu">factor</span>(ppethm_num), </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">design =</span> des, <span class="at">family =</span> <span class="fu">quasibinomial</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pseudo_R2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (model<span class="sc">$</span>deviance <span class="sc">/</span> model<span class="sc">$</span>null.deviance)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pseudo_R2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08989602</code></pre>
</div>
</div>
<p>The pseudo R^2 provides a measure of how well the predictors explain the variability in the response variable. Since this R^2 is low in this case, we don’t consider it as a good fit for this model.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>